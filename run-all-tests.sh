#!/bin/bash

# Script para rodar todos os testes de cotaรงรฃo

set -e

echo ""
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ           TESTE E2E - SISTEMA DE COTAรรO v2                   โ"
echo "โ                                                                โ"
echo "โ  Teste Completo: Criaรงรฃo โ Respostas โ Aceitaรงรฃo              โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

cd /workspaces/acheimeufrete

# Verificar se Python estรก disponรญvel
if ! command -v python3 &> /dev/null; then
    echo "โ Python3 nรฃo encontrado. Instale com: apt-get install python3"
    exit 1
fi

# Verificar se requests estรก disponรญvel
python3 -c "import requests" 2>/dev/null || {
    echo "โ๏ธ  requests nรฃo encontrado. Instalando..."
    pip install requests -q
}

echo "๐ Iniciando testes..."
echo ""

# Teste simples primeiro
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "TESTE 1: Cotaรงรฃo Simples (4 usuรกrios, 4 cotaรงรตes)"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
python3 test-cotacao-simples.py
echo ""
echo "โ TESTE 1 CONCLUรDO"
echo ""

# Teste completo com respostas
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "TESTE 2: Cotaรงรฃo Completa (8 usuรกrios, 7 cotaรงรตes, 28 respostas)"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
python3 test-cotacao-e2e.py
echo ""
echo "โ TESTE 2 CONCLUรDO"
echo ""

# Teste com aceitaรงรฃo
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "TESTE 3: Cotaรงรฃo Completa v2 (com Aceitaรงรฃo de Respostas)"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
python3 test-cotacao-completo-v2.py
echo ""
echo "โ TESTE 3 CONCLUรDO"
echo ""

echo ""
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ                  โ TODOS OS TESTES PASSARAM                  โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ Dados salvos em:"
echo "   โข /tmp/cotacao_test_v2.json"
echo "   โข /tmp/cotacao_test_completo.json"
echo "   โข /tmp/cotacao_test_completo_v2_*.json"
echo ""
echo "๐ Relatรณrio:"
echo "   โข RELATORIO_TESTE_COMPLETO_V2.md"
echo ""
